{% extends 'templates/app.twig' %}

{% block styles %}
    <link rel="stylesheet" href="{{ base_url() }}/css/product.css">
{% endblock %}

{% block content %}
    <h1 class="mb-4">Daftar Produk</h1>

    <div class="products-grid">
        {% for product in products %}
            <div class="product-card">
                {% if product.qty > 10 %}
                    <div class="badge">TERSEDIA</div>
                {% elseif product.qty > 0 and product.qty <= 10 %}
                    <div class="badge warning">TERBATAS</div>
                {% else %}
                    <div class="badge danger">HABIS</div>
                {% endif %}
                
                <div class="tilt">
                    <div class="img">
                        {% if product.image_url %}
                            <img src="{{ product.image_url }}" alt="{{ product.name }}">
                        {% else %}
                            <img src="https://images.unsplash.com/photo-1544383835-bda2bc66a55d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=400" alt="No Image">
                        {% endif %}
                    </div>
                </div>
                
                <div class="info">
                    <div class="cat">{{ product.category|default('Produk') }}</div>
                    <h2 class="title">{{ product.name }}</h2>
                    <p class="desc">
                        {{ product.description|default('Deskripsi belum tersedia')|slice(0, 80) }}
                        {% if product.description and product.description|length > 80 %}...{% endif %}
                    </p>
                    
                    <div class="feats">
                        {% if product.features %}
                            {% for feature in product.features|slice(0, 3) %}
                                <span class="feat">{{ feature }}</span>
                            {% endfor %}
                        {% else %}
                            <span class="feat">Premium Quality</span>
                        {% endif %}
                    </div>
                    
                    <div class="bottom">
                        <div class="price">
                            <span class="new">Rp {{ product.price|number_format(0, ',', '.') }}</span>
                        </div>
                        <a href="/product/{{product.id }}" class="btn">
                            <span>Lihat Detail</span>
                            <svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </a>
                    </div>
                    
                    <div class="meta">
                        <div class="stock {% if product.qty > 0 %}in-stock{% else %}out-stock{% endif %}">
                            {% if product.qty > 0 %}
                                Tersedia: {{ product.qty }}
                            {% else %}
                                Habis
                            {% endif %}
                        </div>
                        <div class="timestamp">
                            {{ product.created_at|date("d M Y") }}
                        </div>
                    </div>
                </div>
            </div>
        {% else %}
            <div class="no-products">
                <p>Tidak ada produk tersedia.</p>
            </div>
        {% endfor %}
    </div>
{% endblock %}